import streamlit as st

st.title("ℹ️ サーキットとは？")

st.markdown("""
本デモでいう **サーキット (Circuit)** とは，Transformer 型言語モデルを
有向グラフとして捉えたときの部分グラフを指します。
ノードは入力，Attention Head，MLP，出力で構成され，
エッジは残差接続を表します。
""")

st.markdown("""
### 理論的な定義
- Transformer 全体は有向非巡回グラフ (DAG) とみなせる。
- サーキットはその部分グラフであり，任意のノードが出力への経路を持つ。
""")

st.markdown("""
### 実装上の定義
- モデル全体をグラフ化し，全エッジに「出力への影響度」スコアを割り当てる。
- スコア上位のエッジを順に選択し，性能や規模の基準を満たした時点の部分グラフをサーキットとする。
""")

st.markdown("""
### 特定方法
本デモでは **EAP-IG (Edge Attribution Patching with Integrated Gradients)** を使用します。
これは，破壊的プロンプトを用いた活性化パッチングに基づき，
入力と破壊プロンプトの間で勾配を積分することで，
より忠実な出力寄与度を推定する手法です。
""")
